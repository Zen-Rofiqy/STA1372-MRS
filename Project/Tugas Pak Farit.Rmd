---
title: "Tugas Pak Farit"
author: "Angga Fathan Rofiqy"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: hide
    toc_depth: 3
    number_sections: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
pkgdown:
  as_is: true
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}

install_load("DT")
```

![](images/WhatsApp%20Image%202024-05-04%20at%2022.00.29_c932357b.jpg)

-   Teruntuk poin strategi percontohan, dibebaskan mau pake populasi terhingga ataupun tak terhingga.
-   Untuk nilai tengah yang dipilih jadinya pakai nilai rata-rata saja.

# Ketakbiasan Penduga

## Jenis sebaran populasi (takhingga)

Jenis sebaran populasi yang akan saya gunakan kali ini adalah populsi **takhingga**. Ini mengasumsikan bahwa populasinya merupakan sebuah populasi takhingga yang menyebar suatu sebaran, misalnya menyebar eksponensial.

Sejalan dengan fungsi pembangkit bilaganan acak dalam R merupakan sampling dari sebaran asli. Sehingga ketika kita melakukan pembangkitan bilangan acak, itu bisa langsung dianggap sampling jika langsung menggunakan fungsi pembangkit bilangan acak seperti `rexp`. Ini tidak berlaku jika kita mencampur fungsi nya.

Kali ini saya akan sampling dengan langsung membangkitkan bilangan acaknya dengan fungsi yang sudah tersedia (`rnorm`, `runif`, `rexp` dsb). Saya akan mencoba 3 sebaran, yakni sebaran Normal, Seragam, dan Eksponensial(1). Ukuran contoh (n) yang akan saya gunakan untuk setiap sebaran adalah 10, dengan ulangan untuk simulasi (k) = 1000.

Saya menentukan parameter populasi untuk sebaran setiap sebaran sebagai berikut:

| Sebaran          | Nilai tengah        | Ragam                                |
|-----------------|--------------------|-----------------------------------|
| Normal (60, 16)  | $\mu=60$            | $\sigma^2=16$                        |
| Seragam (0, 1)   | $\frac{a+b}{2}=0.5$ | $\frac{(b-a)^2}{12} \approx 0.08334$ |
| Eksponensial (1) | $\theta=1$          | $\theta^2=1$                         |

Dimana a=0, dan b=1 untuk Seragam(0, 1). Namun ada perbedaan dalam fungsi r, yakni pada fungsi `rnorm` parameternya adalah `rnorm(n, mean, sd)`, sehingga `sd` yang saya tetapkan adalah $\sqrt{16}=4$. Lalu pada fungsi `rexp` parameternya adalah `rexp(n, rate = 1)`, dimana `rate` = $\frac{1}{\theta}$, sehingga semakin besar rate, maka akan semakin kecil selisih min max pada sebaran eksponensial.

> Berikut merupakan hasil dari simulasi pembangkitan bilangan acak nya:

```{r fig.height=3.5, fig.width=15, dpi=300}
mean(apply(norm_pop, 1, mean))
mean(apply(norm_pop, 1, median))
mean(apply(norm_pop, 1, sd))
print("")
mean(norm_pop)
median(norm_pop)
sd(norm_pop)

set.seed(123)
par(mfrow=c(1,5))
hist(rexp(n*k, rate=1))
hist(rexp(n*k, rate=2))
hist(rexp(n*k, rate=3))
hist(rexp(n*k, rate=4))
hist(rexp(n*k, rate=5))
```

```{r fig.height=3.5, fig.width=10, dpi=300}
set.seed(361)
# k=ulangan simulasi, n=sample
k = 1000; n = 10

par(mfrow = c(1, 3))
# Sebaran Normal
norm_sample <- matrix(rnorm(n*k, mean=60, sd=4), n)

hist(norm_sample, 
     main = paste0("Sebaran Normal\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#83D1C4")

# Sebaran Seragam(0,1)
unif_sample <- matrix(runif(n*k, min=0, max=1), n)

hist(unif_sample, 
     main = paste0("Sebaran Seragam(0,1)\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#78517C")

# Sebaran Eksponensial(1)
exp_sample <- matrix(rexp(n*k, rate=1), n)

hist(exp_sample, 
     main = paste0("Sebaran Eksponensial(1)\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#F17950")
```

Bentuk sebarannya sangat seperti sebaran normal/seragam/eksponensial. Ini berkat banyaknya ulangan simulasi, yakni k=1000. Jadi sejatinya sebaran diatas adalah gabunan dari sebaran-sebaran normal/seragam/eksponensial yang diulang sebanyak 1000 kali. Agar lebih jelas, mari kita lihat tabel dibawah.

```{r}
datatable(norm_sample, options =list(pageLength=5))
```

Nampak jelas bahwa tadi saya membuat sample dengan `matrix` dengan isi merupakan bilangan acak berukuran 10\*1000, dengan banyaknya baris = 10. Karena, jika kita tidak mengulangnya dan dengan n yang kecil, maka bentuk sebaran masing-masing tidak akan mirip seperti sebaran normal/seragam/eksponensial.

Misalnya untuk ulangan 1 sampai 5 pada setiap sebaran, bentuknya akan seperti ini:

```{r fig.height=3.5, fig.width=12, dpi=300}
par(mfrow=c(1,5))
for(i in 1:5) hist(norm_sample[,i], col = "#83D1C4")
for(i in 1:5) hist(unif_sample[,i], col = "#78517C")
for(i in 1:5) hist(exp_sample[,i], col = "#F17950")
```

## Nilai tengah

Selama ini kita sering melakukan sampling terhadap populasi yang diketahui parameternya, seperti mean dan simpangan bakunya. Namun umumnya kita tidak tahu parameter populasi, sehingga perlu dilakukan pendugaan terhadap parameter, yakni statistik. Untuk nilai tengah, maka statistiknya adalah xbar.

Untuk mengetahui apakah statistik merupakan penga tak bias dari parameter, maka kita bisa mencoba menghitung statistik pada setiap ulangan dan merata-ratakan hasilnya. Lalu dilihat, apakah nilainya berbeda jauh dengan nilai parameternya atau tidak.

Untuk ketakbiasan nilai tengah, saya akan menggunakan fungsi `apply` untuk menerapkan mean pada setiap ulangan (kolom). Namun, mari kita lihat sebarannya terlebih dahulu sebelum melihat ketakbiasannya.

```{r fig.height=3.5, fig.width=10, dpi=300}
set.seed(361)

par(mfrow = c(1, 3))
# Sebaran Normal
norm_mean <- apply(norm_sample, 2, mean)

hist(norm_mean, 
     main = paste0("Sebaran Normal Rata-rata\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#83D1C4")

# Sebaran Seragam(0,1)
unif_mean <- apply(unif_sample, 2, mean)

hist(unif_mean, 
     main = paste0("Sebaran Seragam(0,1) Rata-rata\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#78517C")

# Sebaran Eksponensial(1)
exp_mean <- apply(exp_sample, 2, mean)

hist(exp_mean, 
     main = paste0("Sebaran Eksponensial(1) Rata-rata\nUkuran (n=", n," * k=", k, ")"), 
     xlab = "Nilai", ylab = "Frekuensi", col = "#F17950")
```

Terlihat bahwa nilai tengah untuk sebaran normal sudah mendekati nilai 60, yang berarti $\bar{x}$ merupakan penduga nilai tengah tak bias bagi $\mu$. Lalu untuk sebaran seragam juga nilai pusatnya sudah berada di angka 0.5, ini menandakan bahwa nilai tengah statistik dari sebaran seragam tak berbias bagi nilai tengah parameternya. Begitupula untuk sebaran seragam, kita bisa melihat distribusinya berpusat di nilai 1, yang sama dengan parameternya yakni $\theta=1$.

Namun untuk melihat nilai aslinya, mari kita lihat nilai dibawah.

```{r}
cat(  "# Nilai tengah #",
    "\nNormal (60,16)   :", mean(norm_mean), " \u2248", 60,
    "\nSeragam (0,1)    :", mean(unif_mean), "\u2248", (0+1)/2,
    "\nEksponensial (1) :", mean(exp_mean) , "\u2248", 1)
```

## Ragam

Sama halnya dengan ketabiasan nilai tengah, untuk melihat ketakbiasan ragam bisa dilakukan dengan cara yang sama, bedanya hanya di fungsi `apply`, `FUN` yang digunakan adalah `var`, bukan `mean`.

# Penduga Selang Kepercayaan

# Questionable

## N pembangkitan bilangan acak

```{r fig.height=3.5, fig.width=15, dpi=300}
par(mfrow=c(1,6))
hist(runif(20, min=0, max=1))
hist(runif(50, min=0, max=1))
hist(runif(100, min=0, max=1))
hist(runif(150, min=0, max=1))
hist(runif(200, min=0, max=1))
hist(runif(300, min=0, max=1))
```

```{r}
norm_pop <- matrix(rnorm(N*k, mean=60, sd=4), k)

datatable(norm_pop)
```

```{r fig.height=3.5, fig.width=15, dpi=300}
par(mfrow=c(1,5))
hist(norm_pop[,1])
hist(norm_pop[,5])
hist(norm_pop[,10])
hist(norm_pop[,15])
hist(norm_pop[,20])
```
