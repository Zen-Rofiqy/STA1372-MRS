---
title: "Praktikum 9 - Simpangan Baku"
author: "Zaki Ramadhan Muchlish G1401201015"
date: "2024-04-21"
output: html_document
---

# Percobaan Simpangan Baku

1.  Menentukan populasi
2.  Mengambil contoh sebanyak n
3.  Menghitung mean contoh dan simpan
4.  Mengulang langkah 1-4 sebanyak k kali
5.  Menghitung simpangan baku dari mean contoh

## n = 40

```{r}
set.seed(50)
sample.means <- rep(NA, 1000)
for (i in 1:1000) {
  sample.40 <- rnorm(40, mean = 60, sd = 4)
  sample.means[i] <- mean(sample.40)
}
means40 <- mean(sample.means)
sd40 <- sd(sample.means)
cat("mean = ", means40, "\nSD = ", sd40)
hist(sample.means)
```

## n = 100

```{r}
set.seed(50)
sample.means <- rep(NA, 1000)
for (i in 1:1000) {
  sample.100 <- rnorm(100, mean = 60, sd = 4)
  sample.means[i] <- mean(sample.100)
}
means100 <- mean(sample.means)
sd100 <- sd(sample.means)
cat("mean = ", means100, "\nSD = ", sd100)
hist(sample.means)
```

Terlihat bahwa: 1. ketika ukuran contoh diperbesar, simpangan baku dari sebaran percontohan mean contoh menyusut.

```{r}
cat(sd40, sd100)
```

2.  Ketika ukuran contoh diperbesar, mean dari sebaran percontohan mendekati mean populasi.

```{r}
cat('Contoh 40  =', means40,'\n')
cat('Contoh 100 =', means100,'\n')
cat('Populasi   =', 60)
```

3.  Terdapat hubungan antara simpangan baku populasi dan simpangan baku sebaran percontohan.

$\sigma_\bar x = \sigma / \sqrt{n}$

```{r}
cat('Perhitungan manual 40 contoh  = ', 4/sqrt(40),'Simulasi =', sd40,"\n")
cat('Perhitungan manual 100 contoh = ', 4/sqrt(100),'      Simulasi =', sd100)
```

# Selang Kepercayaan 95% mean contoh

Misal kita punya suatu sekumpulan contoh dari populasi yang menyebar normal dengan mean dan simpangan baku yang diketahui. Kita dapat menduga mean populasi menggunakan sebaran percontohan beserta simpangan baku menggunakan rumus di atas.

## 11 Contoh

```{r}
set.seed(50)
sample.11 <- rnorm(11, mean = 60, sd = 4)
sample.11
```

```{r}
(estimated.mean <- mean(sample.11))
```

```{r}
popSD <- 4
sample.size <- length(sample.11)
(sigma.mu <- popSD/sqrt(sample.size))
```

$\bar x \pm (2 \times \sigma_\bar x) = 59.220 \pm (2 \times 1.206)$

## 44 Contoh

```{r}
set.seed(50)
sample.44 <- rnorm(44, mean = 60, sd = 4)
sample.44
```

```{r}
(estimated.mean <- mean(sample.44))
```

```{r}
popSD <- 4
sample.size <- length(sample.44)
(sigma.mu <- popSD/sqrt(sample.size))
```

$\bar x \pm (2 \times \sigma_\bar x) = 59.597 \pm (2 \times 0.603)$

Ketika banyak contoh diperbesar, selang kepercayaan 95% yang didapatkan lebih kecil.

# Inferensi Praktis (Penduga tak bias Sigma)

Sejauh ini percontohan dilakukan terhadap populasi yang diketahui mean dan simpangan bakunya. Namun, umumnya kita tidak tahu parameter populasi dan perlu dilakukan pendugaan menggunakan simpangan baku contoh (s). Sehingga rumus di atas menjadi rumus Standard Error:

$SE_\bar x = s/ \sqrt{n}$

Apakah s dapat digunakan sebagai penduga yang baik untuk $\sigma$?

```{r}
set.seed(50)
sample.sds <- rep(NA, 1000)
for (i in c(1:1000)) {
  sample.40 <- rnorm(40, mean = 60, sd = 4)
  sample.sds[i] <- sd(sample.40)
}
hist(sample.sds)
```

Terlihat bahwa sebaran percontohan simpangan baku menyebar normal dan mendekati nilai simpangan baku populasi (4), sehingga telah dibuktikan secara simulasi bahwa s adalah penduga tak bias terhadap $\sigma$.

# Latihan

1.  Ulangi simulasi percobaan simpangan baku untuk n = 100 dan n = 500, bandingkan hasilnya!
2.  Ulangi simulasi selang kepercayaan untuk n = 250, apa kesimpulannya?
3.  Uangi simulasi penduga tak bias untuk sebaran eksponensial dan seragam, apakah s tetap tak bias?

## No 1

> Ulangi simulasi percobaan simpangan baku untuk n = 100 dan n = 500, bandingkan hasilnya!

```{r fig.height=3.5, fig.width=10, dpi=300}
set.seed(50)
n100 <- rep(NA, 1000)
for (i in 1:1000) {
  sample.40 <- rnorm(100, mean = 60, sd = 4)
  n100[i] <- mean(sample.40)
}
means100 <- mean(n100)
sd100 <- sd(n100)

n500 <- rep(NA, 1000)
for (i in 1:1000) {
  sample.500 <- rnorm(500, mean = 60, sd = 4)
  n500[i] <- mean(sample.500)
}
means500 <- mean(n500)
sd500 <- sd(n500)

par(mfrow = c(1, 2))
hist(n100)
hist(n500)
```

```{r}
cat(" Untuk n = 100 :\n","mean = ", means100, "\n SD = ", sd100, "\n\n", 
    "Untuk n = 500 :\n","mean = ", means500, "\n SD = ", sd500)
```

Simpangan baku yang semakin kecil menunjukkan bahwa distribusi sampel memiliki tingkat variasi yang lebih rendah atau lebih konsisten. Dalam konteks simulasi yang Anda lakukan, ini mengindikasikan bahwa estimasi rata-rata populasi dari sampel-sampel yang diambil (baik untuk n = 100 maupun n = 500) menjadi semakin stabil atau lebih dekat dengan nilai sebenarnya, karena simpangan bakunya menurun.

Dengan kata lain, semakin kecil simpangan bakunya, semakin akurat estimasi rata-rata populasi dari sampel yang diambil. Ini menggambarkan keandalan atau kepercayaan yang lebih tinggi dalam penggunaan rata-rata sampel sebagai perkiraan rata-rata populasi. Jadi, semakin kecil simpangan bakunya, semakin baik estimasi yang kita miliki tentang rata-rata populasi sebenarnya.

## No 2

> Ulangi simulasi selang kepercayaan untuk n = 250, apa kesimpulannya?

```{r fig.height=3.5, fig.width=7.5, dpi=300}
set.seed(50)
sample.250 <- rnorm(250, mean = 60, sd = 4)
hist(sample.250)
```

```{r}
(estimated.mean <- mean(sample.250))
```

```{r}
popSD <- 4
sample.size <- length(sample.250)
(sigma.mu <- popSD/sqrt(sample.size))
```

$\bar x \pm (2 \times \sigma_\bar x) = 59.72593 \pm (2 \times 0.2529822)$

Ini menunjukkan bahwa dengan meningkatnya ukuran sampel, interval kepercayaan cenderung menyempit, atau dengan kata lain, kita menjadi lebih yakin tentang perkiraan rata-rata populasi.

Dengan kata lain, semakin besar ukuran sampel, semakin akurat perkiraan rata-rata populasi kita, yang tercermin dalam interval kepercayaan yang lebih sempit. Oleh karena itu, dengan meningkatnya ukuran sampel, tingkat kepercayaan kita terhadap estimasi rata-rata populasi meningkat.

## No 3

> Ulangi simulasi penduga tak bias untuk sebaran eksponensial dan seragam, apakah s tetap tak bias?

### Exp

```{r fig.height=3.5, fig.width=10, dpi=300}
set.seed(50)
k <- 1000 # ulangan (gak ada ketentuan berapa nya, alias bebas berapa aja)
sample_size <- c(100, 250, 500)

exp_samples <- lapply(sample_size, function(n) matrix(rexp(n*k),k))

par(mfrow = c(1, 3))
hist(exp_samples[[1]], main = "Sebaran Eksponensial\nUkuran sample (n=2)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#E4B3BA")
hist(exp_samples[[2]], main = "Sebaran Eksponensial\nUkuran sample (n=5)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#DE7C8A")
hist(exp_samples[[3]], main = "Sebaran Eksponensial\nUkuran sample (n=25)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#D44155")
```

```{r fig.height=3.5, fig.width=10, dpi=300}
dist_mean <- function(n, dist_samples){
  dist_means <- list()
  for (i in seq_along(n)) 
    dist_means[[i]] <- apply(dist_samples[[i]], 1, mean)
  return(dist_means)
}

exp_means <- dist_mean(sample_size, exp_samples)

par(mfrow = c(1, 3))
hist(exp_means[[1]], main = "Sebaran Eksponensial\nRata-rata sample (n=2)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#E4B3BA")
hist(exp_means[[2]], main = "Sebaran Eksponensial\nRata-rata sample (n=5)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#DE7C8A")
hist(exp_means[[3]], main = "Sebaran Eksponensial\nRata-rata sample (n=25)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#D44155")
```

```{r}
cat(" Untuk n = ", sample_size[1], " :\n","mean = ", mean(exp_means[[1]]), 
    "\n SD = ", sd(exp_means[[1]]), "\n\n", 
    
    "Untuk n = ", sample_size[2], " :\n","mean = ", mean(exp_means[[2]]), 
    "\n SD = ", sd(exp_means[[2]]), "\n\n", 
    
    "Untuk n = ", sample_size[3], " :\n","mean = ", mean(exp_means[[3]]), 
    "\n SD = ", sd(exp_means[[3]]) )
```

### Unif

```{r fig.height=3.5, fig.width=10, dpi=300}
set.seed(50)
k <- 1000 # ulangan (gak ada ketentuan berapa nya, alias bebas berapa aja)
sample_size <- c(100, 250, 500)

unif_samples <- lapply(sample_size, function(n) matrix(runif(n*k),k))

par(mfrow = c(1, 3))
hist(unif_samples[[1]], main = "Sebaran Seragam\nUkuran sample (n=100)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#c8daf0")
hist(unif_samples[[2]], main = "Sebaran Seragam\nUkuran sample (n=250)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#a2c6eb")
hist(unif_samples[[3]], main = "Sebaran Seragam\nUkuran sample (n=500)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#4493CA")
```

```{r fig.height=3.5, fig.width=10, dpi=300}
unif_means <- dist_mean(sample_size, unif_samples)

par(mfrow = c(1, 3))
hist(unif_means[[1]], main = "Sebaran Seragam\nRata-rata sample (n=2)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#c8daf0")
hist(unif_means[[2]], main = "Sebaran Seragam\nRata-rata sample (n=5)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#a2c6eb")
hist(unif_means[[3]], main = "Sebaran Seragam\nRata-rata sample (n=25)", 
     xlab = "Nilai", ylab = "Frekuensi", col = "#4493CA")
```

```{r}
cat(" Untuk n = ", sample_size[1], " :\n","mean = ", mean(unif_means[[1]]), 
    "\n SD = ", sd(unif_means[[1]]), "\n\n", 
    
    "Untuk n = ", sample_size[2], " :\n","mean = ", mean(unif_means[[2]]), 
    "\n SD = ", sd(unif_means[[2]]), "\n\n", 
    
    "Untuk n = ", sample_size[3], " :\n","mean = ", mean(unif_means[[3]]), 
    "\n SD = ", sd(unif_means[[3]]) )
```

Tentu, penduga rata-rata sampel (mean estimator) yang dihitung dari sampel-sampel dari distribusi eksponensial dan seragam dalam simulasi menunjukkan kecenderungan yang tak bias (unbiased). Ini dapat dilihat dari fakta bahwa nilai rata-rata (mean) dari estimator tersebut cenderung mendekati nilai sebenarnya dari populasi, dan simpangan bakunya (standard deviation) cenderung menurun dengan meningkatnya ukuran sampel (n).

Jadi, berdasarkan hasil simulasi yang diberikan, kita dapat menyimpulkan bahwa penduga rata-rata sampel (mean estimator) untuk distribusi eksponensial dan seragam dalam simulasi tersebut memang tetap tak bias, karena rata-rata estimator mendekati nilai sebenarnya dari populasi, dan simpangan bakunya relatif stabil atau bahkan menurun seiring dengan peningkatan ukuran sampel.
