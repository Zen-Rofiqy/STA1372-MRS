---
title: "Tugas UTS"
author: "Angga Fathan Rofiqy"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: show
    toc_depth: 3
    number_sections: false
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
pkgdown:
  as_is: true
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
path <- function() gsub  ( "\\\\",  "/",  readClipboard ()  )

require("knitr")
opts_knit$set(root.dir = "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 6/2. Teknik Pembelajaran Mesin/Project/Kuliah Tugas Individu 1")

#Export chart
export.chart <- "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 6/2. Teknik Pembelajaran Mesin/Project/Kuliah Tugas Individu 1/Chart"

#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}

install_load("DT","dplyr","ggplot2","gridExtra")
```

# Resampling Jackknife

## Pendahuluan

Proses **pendugaan parameter** selalu didasari dengan **asumsi sebaran** dan **ukuran contoh** yang memadai. **Asumsi sebaran** ini menjadi dasar penentuan **selang kepercayaan** bagi parameter (misal 𝜇). Selang kepercayaan bagi 𝜇 juga **bisa diperoleh** meskipun **contoh acak berukuran kecil** tetapi kita mengasumsikan populasinya memiliki **sebaran Normal**. Seandainya contoh acak berukuran kecil dan sebaran populasinya tidak diketahui, selang kepercayaan bagi parameter **tidak bisa diperoleh** tanpa sebaran.

Contoh acak berukuran kecil tidak jarang diperoleh dan bahkan tidak ada informasi tentang sebarannya. Pendugaan selang bagi parameter harus dengan metode yang didasarkan pada asumsi sebaran. Sebaran populasi data tidak diketahui sehingga kita tidak mempunyai dasar yang kuat untuk menduga selang kepecayaan tanpa sebaran.

> **Jackknife** dapat digunakan sebagai cara **pendugaan selang** dalam kondisi **data berukuran kecil** dan **tidak memenuhi asumsi sebaran**.

### Tujuan

Pada awalnya metode jackknife atau leave-one-out **bertujuan** untuk **menduga bias** dari suatu penduga yang diperkenalkan oleh Maurice Quenouille pada tahun 1949 dan dikembangkan oleh John Tukey pada tahun 1957, yang dikenal dengan Quenouille-Tukey Jackknife. Metode jackknife **serupa** dengan metode **bootstrap** untuk **galat baku**. Metode ini **seperti tipe validasi silang leave-one-out**. Bila 𝒙=(𝑥1, 𝑥2, …, 𝑥𝑛) adalah contoh acak dan 𝒙((𝒊)) adalah subset dari 𝒙 tanpa pengamatan 𝑥𝑖, yaitu 𝒙((𝒊))=(𝑥1, …,𝑥((𝑖−1) ), 𝑥((𝑖+1) ), …, 𝑥𝑛). Jika 𝜃 duga=𝑓𝑛 (𝒙), maka definisikan bahwa 𝜃 duga=𝑓(𝑛−1) ( 𝒙((𝒊) ) ), 𝑖=1, 2, …, 𝑛.

# Kasus 1

## Data

Tabel di bawah ini melaporkan jumlah populasi dari n=49 kota di USA pada tahun 1920 dan 1930, yang dinotasikan dengan u dan x.

```{r}
# Import data ke R
dataCity <- read.table(header = TRUE,text=
'u  x 
138 143
93  104
61  69
179 260
48  75
37  63
29  50
23  48
30  111
2   50
38  52
46  53
71  79
25  57
298 317
74  93
50  58
76  80
381 464
387 459
78  106
60  57
507 634
50  64
77  89
64  77
40  60
136 139
243 291
256 288
94  85
36  46
45  53
67  67
120 115
172 183
66  86
46  65
121 113
44  58
64  63
56  142
40  64
116 130
87  105
43  61
43  50
161 232
36  54
')
```

Berdasarkan data ini, peniliti tertarik untuk menghitung **rasio dari mean** yang nantinya dapat digunakan untuk **menduga populasi** total USA pada **tahun 1930** **berdasarkan** jumlah **populasi** pada **tahun 1920**. Jika kota-kota ini merupakan sampel acak dengan (U,X) menotasikan pasangan nilai populasi dari kota yang terpilih secara acak, maka **total populasi 1930** merupakan **hasil perkalian** antara **total populasi 1920** dengan **rasio** dari ekspetasi **θ=E(X)/E(U)**,yang merupakan **parameter rasio** yang akan **diduga**. Dengan menggunakan JACKNIFE, hitunglah **galat baku** (standard error) dari θ duga, yang merupakan akar dari V(θduga), jika diketahui θduga=x_bar/u_bar!

```{r}
boxplot(dataCity)
```

## Hasil

> 1.  Bangkitan sampel baru dengan menghilangkan satu amatan pada setiap ulangan.

```{r}
n <- nrow(dataCity)
# menghilangkan satu amatan
removeOne <- function(i,data) seq(nrow(data))[-i]
set.seed(123)
index <- sapply(1:n, removeOne, data=dataCity)
```

> 2.  Hitung penduga untuk setiap sampel baru

```{r}
#penduga theta
thetaHat <- function(data) {mean(data$x) / mean(data$u)}
thetaJack <- NULL
for (i in 1:n){  
thetaJack <- c(thetaJack, thetaHat(dataCity[index[ ,i], ]))
}
thetaJack
```

```{r}
mean(thetaJack)
```

> 3.  Gunakan hasil pada b untuk menghitung ragam V(θduga). Ragam V(θduga) bisa didekati menggunakan ragam jacknife V(θ\^(Jack)).

```{r}
# ragam
ragamTheta2 <- (((n-1)^2)/n)*var(thetaJack)
ragamTheta2
```

```{r}
# standard error
sqrt(ragamTheta2)
```

# Kasus 2

## Data

```{r}
store<-LETTERS[1:5]
item1<-c(999,1432,969,1548,1557)
item2<-c(1164,1424,1043,870,1101)
d1<-data.frame(store,item1,item2)
d1
```

```{r}
boxplot(d1[,-1])
```

```{r}
n<-nrow(d1)
teta_hat<-mean(d1$item1)/ 
(mean(d1$item1)+mean(d1$item2))
y<-matrix(NA,n,n-1)
x<-matrix(NA,n,n-1)
for (i in 1:n) {
y[i,]<-d1$item1[-i]
x[i,]<-d1$item2[-i]
}
ybar<-apply(y,1,mean)
xbar<-apply(x,1,mean)
teta_i<-ybar/(xbar+ybar)
teta_jk<-n*teta_hat-(n-1)*mean(teta_i)
var_jk<-(n-1)/n*(sum(teta_i^2)-(n*mean(teta_i)^2))
se_jk<-sqrt(var_jk)
teta_jk;var_jk;se_jk
```

Jadi, perbandingan item1/total item = 0.5379. Sehingga dapat diketahui jumlah item1 dengan item2 cenderung berimbang. Hasil dugaan parameter yang didapatkan dari metode jackknife tidak berbeda jauh dengan bootstrap namun keragaman penduganya lebih besar.

```{r}

```
