---
title: "Untitled"
author: "Angga Fathan Rofiqy"
date: "`r Sys.Date()`"
output: html_document
---

```{r, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}

path <- function() gsub  ( "\\\\",  "/",  readClipboard ()  )
#Copy path, Panggil function di console
#Copy r path, paste ke var yang diinginkan
```

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
require("knitr")
opts_knit$set(root.dir = "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 6/1. Metode Simulasi dan Resampling")
```

# Bab 1

## Ilustrasi

### no 1

![](images/clipboard-2676811128.png){width="431"}

Misalkan ekor (tail) = 0 dan kepala (head) = 1.

```{r}
FlipCoin <- function(n) sample(0:1, n, rep=T) 
n <- 10
e1 <- FlipCoin(n) 
e1 
```

Terlihat isi dari sampel acak yang berjumlah 30 dan akan selalu berubah jika chunk nya di run berulang-ulang. Berikut adalah jumlah banyaknya tail dan head beserta peluangnya.

```{r}
cat("Banyaknya tail :", sum(e1==0), "dan Peluangnya :", sum(e1==0)/n,
    "\nBanyaknya head :", sum(e1==1), "dan Peluangnya :", sum(e1==1)/n)
```

Berikut adalah plot sebaran dari banyaknya hasil tail dan head pada lemparan koin.

```{r}
hist(e1,breaks=c(-0.5, 0.5, 1.5), prob=T) 
```

### no 2

![](images/clipboard-33675307.png){width="436"}

Misalkan Girl (perempuan) = 1 dan Boy (laki-laki) = 0.

```{r}
#Menggunakan function sebelumnya
n <- 28 
gb <- FlipCoin(n)
gb

g = 0; b=0; B=0
for(i in 1:n){
  if(gb[i] == 1){
    g <- g+1
    b <- 0
  } else{
    b <- b+1
  }
  
  if(b==4){
    B <- B+1
    b <- 0
  }
}

cat("Banyaknya anak perempuan :", g,
    "\nBanyaknya 4 anak tanpa perempuan :", B, 
    "\nPeluangnya :", g/(g+B))
```

### no 3

![](images/clipboard-1034759495.png){width="521"}

```{r}
RollDie <- function(n) sample(1:6, n, rep=T)
n <- 50
d1 <- RollDie(n)
d1
```

Selanjutnya akan menghitung berapa kali dadu sisi 3 muncul dan berapa frekuensi relatifnya.

```{r}
cat("Banyaknya tail :", sum(d1==3), "dan Frekuensi Relatifnya :", sum(d1==3)/n)
```

## Latihan

### no 1

![](images/clipboard-112463260.png){width="447"}

> Lempar koin 100 x

```{r}
n <- 100
e2 <- FlipCoin(n) 
cat("Banyaknya tail :", sum(e2==0), "dan Frekuensi Relatifnya :", sum(e2==0)/n,
    "\nBanyaknya head :", sum(e2==1), "dan Frekuensi Relatifnya :", sum(e2==1)/n)
```

Histogram

```{r}
hist(e2, breaks=c(-0.5, 0.5, 1.5), prob=T)
```

> Lempar koin 500 x

```{r}
n <- 500
e3 <- FlipCoin(n) 
cat("Banyaknya tail :", sum(e3==0), "dan Peluangnya :", sum(e3==0)/n,
    "\nBanyaknya head :", sum(e3==1), "dan Peluangnya :", sum(e3==1)/n)
```

Histogram

```{r}
hist(e3, breaks=c(-0.5, 0.5, 1.5), prob=T)
```

### no 2

![](images/clipboard-2216234215.png)

```{r}
Dice <- function(n){
  d <- RollDie(n)
  rolls <- numeric(0)
  for(i in 1:6) rolls = c(rolls, sum(d==i)/n)
return(rolls)
}

RollingDice <- data.frame(
  rolls.200 = Dice(200),
  rolls.1000 = Dice(1000)
) 
rownames(RollingDice) <- paste0("RF.", 1:6)
print(RollingDice)
```

# Bab 2

```{r}
x0 <-73 
n <- 250
a <- 17
b <- 7
m <- 1024

xi <- matrix (NA , n, 3 )
colnames (xi) <-c( "aX(i-1)+b", "Xi", "Ui") 
for  (i in 1 :n){
  xi[i,1] <- (a * x0 + b) 
  xi[i,2] <- xi[i, 1]%%m 
  xi[i,3] <- xi[i, 2]/m 
  x0 <- xi[i,2]
}
hist(xi[,3])

cbind("i"=1:20,    "Xi"=xi[1:20,2], 
      "i"=101:120, "Xi"=xi[101:120,2], 
      "i"=201:220, "Xi"=xi[201:220,2])
```

![](images/clipboard-2916962344.png)

```{r}
n <- 1000
x1 <- 0.9
for(i in 2:n) x1[i] <- (pi + x1[i-1])^5%%1

hist(x1)

cbind("i"=1:20,    "Xi"=xi[1:20,2], 
      "i"=101:120, "Xi"=xi[101:120,2], 
      "i"=201:220, "Xi"=xi[201:220,2])
```

## Soal 3.5

```{r, warning=FALSE, message = FALSE}
install_load('readxl','dplyr','kableExtra','DT')
raw.data <- read_xlsx("Data pert 2.xlsx")
data <- raw.data
```
